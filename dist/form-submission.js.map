{
  "version": 3,
  "sources": ["../form-submission.js"],
  "sourcesContent": ["window.Webflow?.push(async () => {\n  try {\n    let errorDiv;\n    let successDiv;\n\n    console.log(\"Submission Flow\");\n\n    // 1. Remove w-form to prevent Webflow from handling it\n    const emailForm = document.getElementById(\"email-form\");\n\n    if (emailForm && emailForm.parentElement) {\n      emailForm.parentElement.classList.remove(\"w-form\");\n\n      // MutationObserver to watch for class changes\n      const observer = new MutationObserver(function (mutations) {\n        mutations.forEach(function (mutation) {\n          if (mutation.attributeName === \"class\") {\n            emailForm.parentElement.classList.remove(\"w-form\");\n          }\n        });\n      });\n\n      // Configuration of the observer\n      observer.observe(emailForm.parentElement, {\n        attributes: true, // Configure it to listen to attribute changes\n      });\n\n      // Find select elements\n      nameElement = document.getElementById(\"name\");\n      emailElement = document.getElementById(\"email\");\n      dateElement = document.querySelector(\".date-field\");\n      if (window.innerWidth <= 768) {\n        dateMobile = document.querySelector(\".flatpickr-mobile\");\n        dateElement.style.appearance = \"none\";\n      }\n\n      nameElement.style.appearance = \"none\";\n      emailElement.style.appearance = \"none\";\n      dateElement.style.appearance = \"none\";\n\n      // 2. Find the error and success divs\n      errorDiv = emailForm.parentElement.querySelector(\n        '[data-name-form=\"error\"]'\n      );\n\n      successDiv = emailForm.parentElement.querySelector(\n        '[data-name-form=\"success\"]'\n      );\n\n      errorDiv.style.display = \"none\";\n      successDiv.style.display = \"none\";\n\n      // Google Sign-In button\n      // google.accounts.id.initialize({\n      //   client_id:\n      //     \"597521131034-6amd34ifc637c39bhu2dvclns4aptnna.apps.googleusercontent.com\",\n      //   callback: handleGoogleCredentialResponse,\n      // });\n      // google.accounts.id.renderButton(\n      //   document.getElementById(\"google-signin-button\"),\n      //   {\n      //     theme: \"outline\",\n      //     size: \"large\",\n      //     // width: \"auto\",\n      //     logo_alignment: \"center\",\n      //     // type: 'icon'\n      //   }\n      // );\n\n      // Handle Google Sign-In response\n      // async function handleGoogleCredentialResponse(response) {\n      //   const data = jwt_decode(response.credential);\n      //   const userEmail = data.email;\n      //   const fullName = data.name;\n\n      //   // Automatically fill in the email field with the user's Google email\n      //   if (emailElement) {\n      //     console.log(userEmail, fullName);\n      //     emailElement.value = userEmail;\n      //   }\n\n      //   // Automatically fill in the name field with the user's Google full name\n      //   if (nameElement) {\n      //     nameElement.value = fullName;\n      //   }\n\n      //   // Optionally submit the form automatically after Google Sign-In\n      //   // emailForm.dispatchEvent(new Event(\"submit\"));\n      // }\n\n      // Function to detect the browser from user-agent string\n      function detectBrowser() {\n        const userAgent = navigator.userAgent;\n        let browserName = \"Unknown\";\n        let browserVersion = \"\";\n\n        if (\n          userAgent.indexOf(\"Chrome\") > -1 &&\n          userAgent.indexOf(\"Edg\") === -1\n        ) {\n          browserName = \"Chrome\";\n          browserVersion = userAgent.match(/Chrome\\/([\\d.]+)/)?.[1] || \"\";\n        } else if (\n          userAgent.indexOf(\"Safari\") > -1 &&\n          userAgent.indexOf(\"Chrome\") === -1\n        ) {\n          browserName = \"Safari\";\n          browserVersion = userAgent.match(/Version\\/([\\d.]+)/)?.[1] || \"\";\n        } else if (userAgent.indexOf(\"Firefox\") > -1) {\n          browserName = \"Firefox\";\n          browserVersion = userAgent.match(/Firefox\\/([\\d.]+)/)?.[1] || \"\";\n        } else if (userAgent.indexOf(\"Edg\") > -1) {\n          browserName = \"Edge\";\n          browserVersion = userAgent.match(/Edg\\/([\\d.]+)/)?.[1] || \"\";\n        } else if (\n          userAgent.indexOf(\"Opera\") > -1 ||\n          userAgent.indexOf(\"OPR\") > -1\n        ) {\n          browserName = \"Opera\";\n          browserVersion =\n            userAgent.match(/Opera\\/([\\d.]+)|OPR\\/([\\d.]+)/)?.[1] || \"\";\n        } else if (\n          userAgent.indexOf(\"MSIE\") > -1 ||\n          !!document.documentMode === true\n        ) {\n          // IE\n          browserName = \"Internet Explorer\";\n          browserVersion = userAgent.match(/MSIE ([\\d.]+)/)?.[1] || \"\";\n        }\n\n        return { browserName, browserVersion };\n      }\n\n      // 3. Add our own submit handler\n      emailForm.onsubmit = async (event) => {\n        try {\n          event.preventDefault();\n\n          // 4. Get the IP address\n          let ip;\n          try {\n            const response = await fetch(\"https://api.ipify.org?format=json\");\n            const json = await response.json();\n            ip = json.ip;\n          } catch (err) {\n            console.error(`Error getting IP Address: ${err}`);\n          }\n\n          const userAgent = navigator.userAgent;\n\n          // 5. Detect device type\n          const deviceType = /Mobi|Android/i.test(userAgent)\n            ? \"Mobile\"\n            : /Tablet/i.test(userAgent)\n            ? \"Tablet\"\n            : \"Desktop\";\n\n          // 6. Detect language preference\n          const language = navigator.language || navigator.userLanguage;\n\n          // 7. Detect browser type and version\n          const { browserName, browserVersion } = detectBrowser();\n\n          function getCookieValue(name) {\n            const value = `; ${document.cookie}`;\n            const parts = value.split(`; ${name}=`);\n            if (parts.length === 2) return parts.pop().split(\";\").shift();\n          }\n\n          const queryString = window.location.search;\n          const urlParams = new URLSearchParams(queryString);\n\n          const cid = urlParams.get(\"cid\") || \"\";\n          const tid = urlParams.get(\"ecid\") || \"\";\n          const aff = urlParams.get(\"aff\") || \"\";\n          const s1 = urlParams.get(\"s1\") || \"\";\n          const s2 = urlParams.get(\"s2\") || \"\";\n          const s3 = urlParams.get(\"s3\") || \"\";\n          const s4 = urlParams.get(\"s4\") || \"\";\n          const cpid = urlParams.get(\"cpid\") || \"\";\n          const fbid = getCookieValue(\"_fbc\") || \"\";\n\n          const formData = new FormData(emailForm);\n\n          // 5. Get the form entries as an object\n          const formObj = Object.fromEntries(formData.entries());\n\n          const data = {\n            full_name: formObj.name,\n            email: formObj.email,\n            birth_day: formObj.Date,\n            affiliate: aff,\n            transaction_id: tid,\n            s1: s1,\n            s2: s2,\n            s3: s3,\n            s4: s4,\n            ip_address: ip,\n            user_agent: userAgent,\n            device_type: deviceType, // Device Type\n            language: language, // Language\n            browser_name: browserName, // Browser Name\n            browser_version: browserVersion, // Browser Version\n            clickid: cid,\n            campaign_id: cpid,\n            fb_clickid: fbid,\n          };\n          console.log(\"data to send to server:\", data);\n          // 6. Send the data to the server\n          // https://bonusgem-api-afvof.ondigitalocean.app/v1/submission\n          //http://127.0.0.1:8000/v1/submission\n          const response = await fetch(\n            \"https://lobster-app-y7aqm.ondigitalocean.app/v1/submission\",\n            {\n              method: \"POST\",\n              body: JSON.stringify(data),\n              headers: {\n                \"Content-Type\": \"application/json\",\n              },\n            }\n          );\n          const responseData = await response.json();\n\n          if (response.status !== 200) {\n            if (responseData.detail === \"Email is invalid\") {\n              document.getElementById(\"error-text\").innerText =\n                \"Oops! Something went wrong, your email is invalid\";\n            }\n            throw new Error(\"Response status is not 200\");\n          }\n\n          // Hide the form and show the success message\n          emailForm.style.display = \"none\";\n          successDiv.style.display = \"block\";\n          let smartLink;\n          let params;\n          if (\n            cpid === \"4f244fe9-6f46-4cdc-a5f3-f374de1a4b36\" ||\n            cpid === \"f9b49d82-1a35-4ad5-91b3-278ecfa966bf\"\n          ) {\n            const adset_id = urlParams.get(\"ad_id\") || \"\";\n            const campaign_id = urlParams.get(\"campaign_id\") || \"\";\n            const source = urlParams.get(\"source\") || \"\";\n            const placement = urlParams.get(\"placement\") || \"\";\n            params = `adset_id=${adset_id}&campaign_id=${campaign_id}&source=${source}&placement=${placement}&user_id=${cid}`;\n            smartLink = `https://bgtracking.com/8786a759-e9f1-4a6d-a5b6-a2837876fc67?`;\n          } else {\n            params = `aff=${aff}&s1=${s1}&s2=${s2}&s3=${s3}&s4=${s4}&ecid=${tid}&s5=${cid}`;\n            smartLink = \"https://bgtracking.com/127682d4-4160-48ce-b003-88aa443950e0?\";\n          }\n\n          setTimeout(() => {\n            window.location.href = `${smartLink}${params}`;\n          }, 500);\n        } catch (e) {\n          // 8. Handle the error\n          if (e instanceof Error) {\n            errorDiv.style.display = \"block\";\n            console.error(e);\n          }\n        }\n      };\n    }\n  } catch (e) {\n    console.error(\"error\", e);\n    // errorDiv.style.display = 'block';\n  }\n});\n//# sourceMappingURL=main.js.map\n"],
  "mappings": "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",
  "names": ["errorDiv", "successDiv", "emailForm", "detectBrowser", "userAgent", "browserName", "browserVersion", "mutations", "mutation", "event", "getCookieValue", "name", "parts", "ip", "err", "deviceType", "language", "queryString", "urlParams", "cid", "tid", "aff", "s1", "s2", "s3", "s4", "cpid", "fbid", "formData", "formObj", "data", "response", "responseData", "smartLink", "params", "adset_id", "campaign_id", "source", "placement", "e"]
}
