(()=>{window.Webflow?.push(async()=>{try{let r,f;console.log("Submission Flow");let a=document.getElementById("email-form");if(a&&a.parentElement){let v=function(){let e=navigator.userAgent,s="Unknown",t="";return e.indexOf("Chrome")>-1&&e.indexOf("Edg")===-1?(s="Chrome",t=e.match(/Chrome\/([\d.]+)/)?.[1]||""):e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1?(s="Safari",t=e.match(/Version\/([\d.]+)/)?.[1]||""):e.indexOf("Firefox")>-1?(s="Firefox",t=e.match(/Firefox\/([\d.]+)/)?.[1]||""):e.indexOf("Edg")>-1?(s="Edge",t=e.match(/Edg\/([\d.]+)/)?.[1]||""):e.indexOf("Opera")>-1||e.indexOf("OPR")>-1?(s="Opera",t=e.match(/Opera\/([\d.]+)|OPR\/([\d.]+)/)?.[1]||""):(e.indexOf("MSIE")>-1||document.documentMode)&&(s="Internet Explorer",t=e.match(/MSIE ([\d.]+)/)?.[1]||""),{browserName:s,browserVersion:t}};var F=v;a.parentElement.classList.remove("w-form"),new MutationObserver(function(e){e.forEach(function(s){s.attributeName==="class"&&a.parentElement.classList.remove("w-form")})}).observe(a.parentElement,{attributes:!0}),nameElement=document.getElementById("name"),emailElement=document.getElementById("email"),dateElement=document.querySelector(".date-field"),window.innerWidth<=768&&(dateMobile=document.querySelector(".flatpickr-mobile"),dateElement.style.appearance="none"),nameElement.style.appearance="none",emailElement.style.appearance="none",dateElement.style.appearance="none",r=a.parentElement.querySelector('[data-name-form="error"]'),f=a.parentElement.querySelector('[data-name-form="success"]'),r.style.display="none",f.style.display="none",a.onsubmit=async e=>{try{let O=function(o){let m=`; ${document.cookie}`.split(`; ${o}=`);if(m.length===2)return m.pop().split(";").shift()};var s=O;e.preventDefault();let t;try{t=(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch(o){console.error(`Error getting IP Address: ${o}`)}let p=navigator.userAgent,S=/Mobi|Android/i.test(p)?"Mobile":/Tablet/i.test(p)?"Tablet":"Desktop",k=navigator.language||navigator.userLanguage,{browserName:j,browserVersion:D}=v(),I=window.location.search,n=new URLSearchParams(I),i=n.get("cid")||"",g=n.get("ecid")||"",u=n.get("aff")||"",b=n.get("s1")||"",y=n.get("s2")||"",h=n.get("s3")||"",w=n.get("s4")||"",c=n.get("cpid")||"",M=O("_fbc")||"",T=new FormData(a),E=Object.fromEntries(T.entries()),_={full_name:E.name,email:E.email,birth_day:E.Date,affiliate:u,transaction_id:g,s1:b,s2:y,s3:h,s4:w,ip_address:t,user_agent:p,device_type:S,language:k,browser_name:j,browser_version:D,clickid:i,campaign_id:c,fb_clickid:M};console.log("data to send to server:",_);let x=await fetch("https://lobster-app-y7aqm.ondigitalocean.app/v1/submission",{method:"POST",body:JSON.stringify(_),headers:{"Content-Type":"application/json"}}),q=await x.json();if(x.status!==200)throw q.detail==="Email is invalid"&&(document.getElementById("error-text").innerText="Oops! Something went wrong, your email is invalid"),new Error("Response status is not 200");a.style.display="none",f.style.display="block";let l,d;if(c==="4f244fe9-6f46-4cdc-a5f3-f374de1a4b36"||c==="f9b49d82-1a35-4ad5-91b3-278ecfa966bf"){let o=n.get("ad_id")||"",$=n.get("campaign_id")||"",m=n.get("source")||"",A=n.get("placement")||"";d=`adset_id=${o}&campaign_id=${$}&source=${m}&placement=${A}&user_id=${i}`,l="https://bgtracking.com/8786a759-e9f1-4a6d-a5b6-a2837876fc67?"}else c==="d81c84e7-a589-4f90-8273-6fd6cff68457"?(d=`aff=${u}&s1=${b}&s2=${y}&s3=${h}&s4=${w}&ecid=${g}&s5=${i}`,l="https://bgtracking.com/d81c84e7-a589-4f90-8273-6fd6cff68457"):(d=`aff=${u}&s1=${b}&s2=${y}&s3=${h}&s4=${w}&ecid=${g}&s5=${i}`,l="https://bgtracking.com/127682d4-4160-48ce-b003-88aa443950e0?");setTimeout(()=>{window.location.href=`${l}${d}`},500)}catch(t){t instanceof Error&&(r.style.display="block",console.error(t))}}}}catch(r){console.error("error",r)}});})();
//# sourceMappingURL=form-submission.js.map
