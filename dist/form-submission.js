(()=>{window.Webflow?.push(async()=>{try{let a,r;console.log("Submission Flow");let o=document.getElementById("email-form");if(o&&o.parentElement){let c=function(){let e=navigator.userAgent,t="Unknown",n="";return e.indexOf("Chrome")>-1&&e.indexOf("Edg")===-1?(t="Chrome",n=e.match(/Chrome\/([\d.]+)/)?.[1]||""):e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1?(t="Safari",n=e.match(/Version\/([\d.]+)/)?.[1]||""):e.indexOf("Firefox")>-1?(t="Firefox",n=e.match(/Firefox\/([\d.]+)/)?.[1]||""):e.indexOf("Edg")>-1?(t="Edge",n=e.match(/Edg\/([\d.]+)/)?.[1]||""):e.indexOf("Opera")>-1||e.indexOf("OPR")>-1?(t="Opera",n=e.match(/Opera\/([\d.]+)|OPR\/([\d.]+)/)?.[1]||""):(e.indexOf("MSIE")>-1||document.documentMode)&&(t="Internet Explorer",n=e.match(/MSIE ([\d.]+)/)?.[1]||""),{browserName:t,browserVersion:n}};var D=c;o.parentElement.classList.remove("w-form"),new MutationObserver(function(e){e.forEach(function(t){t.attributeName==="class"&&o.parentElement.classList.remove("w-form")})}).observe(o.parentElement,{attributes:!0}),nameElement=document.getElementById("name"),emailElement=document.getElementById("email"),dateElement=document.querySelector(".date-field"),window.innerWidth<=768&&(dateMobile=document.querySelector(".flatpickr-mobile"),dateElement.style.appearance="none"),nameElement.style.appearance="none",emailElement.style.appearance="none",dateElement.style.appearance="none",a=o.parentElement.querySelector('[data-name-form="error"]'),r=o.parentElement.querySelector('[data-name-form="success"]'),a.style.display="none",r.style.display="none",o.onsubmit=async e=>{try{e.preventDefault();let t;try{t=(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch(w){console.error(`Error getting IP Address: ${w}`)}let n=navigator.userAgent,E=/Mobi|Android/i.test(n)?"Mobile":/Tablet/i.test(n)?"Tablet":"Desktop",h=navigator.language||navigator.userLanguage,{browserName:v,browserVersion:O}=c(),x=window.location.search,s=new URLSearchParams(x),l=s.get("cid")||"",d=s.get("ecid")||"",m=s.get("aff")||"",f=s.get("s1")||"",p=s.get("s2")||"",g=s.get("s3")||"",u=s.get("s4")||"",S=s.get("cpid")||"",$=new FormData(o),i=Object.fromEntries($.entries()),y={full_name:i.name,email:i.email,birth_day:i.Date,affiliate:m,transaction_id:d,s1:f,s2:p,s3:g,s4:u,ip_address:t,user_agent:n,device_type:E,language:h,browser_name:v,browser_version:O,clickid:l,campaign_id:S};console.log("data to send to server:",y);let b=await fetch("https://lobster-app-y7aqm.ondigitalocean.app/v1/submission",{method:"POST",body:JSON.stringify(y),headers:{"Content-Type":"application/json"}}),_=await b.json();if(b.status!==200)throw _.detail==="Email is invalid"&&(document.getElementById("error-text").innerText="Oops! Something went wrong, your email is invalid"),new Error("Response status is not 200");o.style.display="none",r.style.display="block";let j="https://bgtracking.com/127682d4-4160-48ce-b003-88aa443950e0?",k=`aff=${m}&s1=${f}&s2=${p}&s3=${g}&s4=${u}&ecid=${d}&cid=${l}`;setTimeout(()=>{window.location.href=`${j}${k}`},500)}catch(t){t instanceof Error&&(a.style.display="block",console.error(t))}}}}catch(a){console.error("error",a)}});})();
//# sourceMappingURL=form-submission.js.map
