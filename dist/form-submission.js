(()=>{window.Webflow?.push(async()=>{try{let o,a;console.log("Submission Flow");let e=document.getElementById("email-form");e&&e.parentElement&&(e.parentElement.classList.remove("w-form"),new MutationObserver(function(r){r.forEach(function(t){t.attributeName==="class"&&e.parentElement.classList.remove("w-form")})}).observe(e.parentElement,{attributes:!0}),stateElement=document.getElementById("State"),dayElement=document.getElementById("Day"),monthElement=document.getElementById("Month"),yearElement=document.getElementById("Year"),stateElement.style.appearance="none",dayElement.style.appearance="none",monthElement.style.appearance="none",yearElement.style.appearance="none",o=e.parentElement.querySelector('[data-name-form="error"]'),a=e.parentElement.querySelector('[data-name-form="success"]'),o.style.display="none",a.style.display="none",e.onsubmit=async r=>{try{r.preventDefault();let t;try{t=(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch(f){console.error(`Error getting IP Address: ${f}`)}let g=navigator.userAgent,E=window.location.search,n=new URLSearchParams(E),i=n.get("cid"),c=n.get("aff")||"",l=n.get("s1")||"",m=n.get("s2")||"",d=n.get("s3")||"",p=n.get("s4")||"",w=new FormData(e),s=Object.fromEntries(w.entries()),y={full_name:s.name,email:s.email,state:s.State,birth_day:`${s.Year}-${s.Month}-${s.Day}`,affiliate:c,transaction_id:i,s1:l,s2:m,s3:d,s4:p,ip_address:t,user_agent:g};console.log("data to send to server:",y);let u=await fetch("https://bonusgem-api-afvof.ondigitalocean.app/v1/submission",{method:"POST",body:JSON.stringify(y),headers:{"Content-Type":"application/json"}}),h=await u.json();if(u.status!==200)throw h.detail==="Email is invalid"&&(document.getElementById("error-text").innerText="Oops! Something went wrong, your email is invalid"),new Error("Response status is not 200");e.style.display="none",a.style.display="block";let b="https://www.hevuv.com/cmp/GJRHSG88/3MQKZT/?",v=`transaction_id=${i}&source_id=${c}&sub1=${l}&sub2=${m}&sub3=${d}&sub4=${p}&sub5=${i}`;setTimeout(()=>{window.location.href=`${b}${v}`},500)}catch(t){t instanceof Error&&(o.style.display="block",console.error(t))}})}catch(o){console.error("error",o)}});})();
//# sourceMappingURL=form-submission.js.map
