(()=>{window.Webflow?.push(async()=>{try{let s,i;console.log("Submission Flow");let n=document.getElementById("email-form");if(n&&n.parentElement){let f=function(){let e=navigator.userAgent,a="Unknown",t="";return e.indexOf("Chrome")>-1&&e.indexOf("Edg")===-1?(a="Chrome",t=e.match(/Chrome\/([\d.]+)/)?.[1]||""):e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1?(a="Safari",t=e.match(/Version\/([\d.]+)/)?.[1]||""):e.indexOf("Firefox")>-1?(a="Firefox",t=e.match(/Firefox\/([\d.]+)/)?.[1]||""):e.indexOf("Edg")>-1?(a="Edge",t=e.match(/Edg\/([\d.]+)/)?.[1]||""):e.indexOf("Opera")>-1||e.indexOf("OPR")>-1?(a="Opera",t=e.match(/Opera\/([\d.]+)|OPR\/([\d.]+)/)?.[1]||""):(e.indexOf("MSIE")>-1||document.documentMode)&&(a="Internet Explorer",t=e.match(/MSIE ([\d.]+)/)?.[1]||""),{browserName:a,browserVersion:t}};var A=f;n.parentElement.classList.remove("w-form"),new MutationObserver(function(e){e.forEach(function(a){a.attributeName==="class"&&n.parentElement.classList.remove("w-form")})}).observe(n.parentElement,{attributes:!0}),nameElement=document.getElementById("name"),emailElement=document.getElementById("email"),dateElement=document.querySelector(".date-field"),window.innerWidth<=768&&(dateMobile=document.querySelector(".flatpickr-mobile"),dateElement.style.appearance="none"),nameElement.style.appearance="none",emailElement.style.appearance="none",dateElement.style.appearance="none",s=n.parentElement.querySelector('[data-name-form="error"]'),i=n.parentElement.querySelector('[data-name-form="success"]'),s.style.display="none",i.style.display="none",n.onsubmit=async e=>{try{let p=function(r){let x=`; ${document.cookie}`.split(`; ${r}=`);if(x.length===2)return x.pop().split(";").shift()};var a=p;e.preventDefault();let t;try{t=(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch(r){console.error(`Error getting IP Address: ${r}`)}let c=navigator.userAgent,S=/Mobi|Android/i.test(c)?"Mobile":/Tablet/i.test(c)?"Tablet":"Desktop",$=navigator.language||navigator.userLanguage,{browserName:k,browserVersion:_}=f(),j=window.location.search,o=new URLSearchParams(j),u=o.get("cid")||"",g=o.get("ecid")||"",b=o.get("aff")||"",y=o.get("s1")||"",h=o.get("s2")||"",w=o.get("s3")||"",E=o.get("s4")||"",l=o.get("cpid")||"",D=p("_fbc")||"",I=new FormData(n),d=Object.fromEntries(I.entries()),v={full_name:d.name,email:d.email,birth_day:d.Date,affiliate:b,transaction_id:g,s1:y,s2:h,s3:w,s4:E,ip_address:t,user_agent:c,device_type:S,language:$,browser_name:k,browser_version:_,clickid:u,campaign_id:l,fb_clickid:D};console.log("data to send to server:",v);let O=await fetch("https://lobster-app-y7aqm.ondigitalocean.app/v1/submission",{method:"POST",body:JSON.stringify(v),headers:{"Content-Type":"application/json"}}),M=await O.json();if(O.status!==200)throw M.detail==="Email is invalid"&&(document.getElementById("error-text").innerText="Oops! Something went wrong, your email is invalid"),new Error("Response status is not 200");n.style.display="none",i.style.display="block";let m,T=`aff=${b}&s1=${y}&s2=${h}&s3=${w}&s4=${E}&ecid=${g}&cid=${u}`;l==="4f244fe9-6f46-4cdc-a5f3-f374de1a4b36"||l==="f9b49d82-1a35-4ad5-91b3-278ecfa966bf"?m="https://bgtracking.com/8786a759-e9f1-4a6d-a5b6-a2837876fc67?":m="https://bgtracking.com/127682d4-4160-48ce-b003-88aa443950e0?",setTimeout(()=>{window.location.href=`${m}${T}`},500)}catch(t){t instanceof Error&&(s.style.display="block",console.error(t))}}}}catch(s){console.error("error",s)}});})();
//# sourceMappingURL=form-submission.js.map
